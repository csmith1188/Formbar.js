<!DOCTYPE html>
<%- include('../partials/header_content') %>
<%- include('../partials/sockets') %>

        <html lang="en">

        <head>
            <style>
                body {
                    padding-top: 52px !important;
                }

                td, th {
                    padding: 20px 35px;
                    border-bottom: 2px solid var(--lightMode-menu-border);
                }

                table {
                    border-spacing: 0;
                }

                tr {
                    position: relative;
                }

                div.transactionHistory {
                    width: 100%;
                    height: 100vh;
                    display: flex;
                    justify-content: start;
                    align-items: center;
                    overflow: scroll;
                    flex-direction: column;
                    padding: 5px 0 60px 0;
                }
                
                .buttons {
                    display: flex;
                    flex-direction: row;
                    gap: 10px;
                    margin-top: 10px;
                }

                .description {
                    max-width: 400px;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

            </style>
        </head>

        <body role="document" tabindex="0">
            <%- include('../partials/formbar_header') %>

            
            <div class="transactionHistory">
                <h1>Your pog pools!</h1>

                <table class="revampDiv">
                    <tr>
                        <th>Owner</th>
                        <th>Members</th>
                        <th>Description</th>
                        <th>Amount</th>
                        <th>Options</th>
                    </tr>

                    <% JSON.parse(pools).forEach(function(pool) { %>
                        <tr id="pool-<%=pool.id%>">
                            <td><%= pool.owner.id == currentUser.id ? "You" : pool.owner.id %></td>
                            <td><%= pool.members.length > 0 ? pool.members : "None" %></td>
                            <td class="description" title="<%= pool.description %>"><%= pool.description %></td>
                            <td><%= pool.amount %></td>
                            <td><% if(pool.owner.id == currentUser.id) { %>
                                    <button class="revampButton acceptButton squareButton" style="padding: 5px;">
                                        <img src="/img/pencil-outline.svg" alt="" style="filter: invert(0) !important">
                                    </button>
                                <% } else { %>
                                    <button class="revampButton acceptButton squareButton" style="padding: 5px;cursor: not-allowed;" disabled>
                                        <img src="/img/pencil-outline.svg" alt="" style="filter: invert(0) !important">
                                    </button>
                                <% } %>
                            </td>
                        </tr>
                    <% }); %>
                </table>
            </div>
        </body>
        
                    
        <script>
            socket.on('poolCreateResponse', (data) => {
                console.log(data)
            })

            socket.on('poolDeleteResponse', (data) => {
                console.log(data)
            })

            socket.on('poolAddMemberResponse', (data) => {
                console.log(data)
            })

            socket.on('poolRemoveMemberResponse', (data) => {
                console.log(data)
            })

            socket.on('poolPayoutResponse', (data) => {
                console.log(data)
            })
        </script>
</html>