<script src="/socket.io/socket.io.js"></script>

<script defer>
	let socket = io()

	function endBreak() {
		socket.emit('endBreak')
		document.getElementById('breakDialog').close()
		document.getElementById("backgroundDarken").classList.remove('open')
	}

	socket.on('break', (isApproved) => {
        const breakDialog = document.getElementById('breakDialog');
        const backgroundDarken = document.getElementById('backgroundDarken');
        if (isApproved) {
            breakDialog.showModal();
            backgroundDarken.classList.add('open');
        } else {
            breakDialog.close();
            backgroundDarken.classList.remove('open');
        }
	})

	socket.on('message', (message) => {
		alert(message)
	})

	socket.on('reload', (redirectURL) => {
        if (window.reloadRedirect) {
            redirectURL = window.reloadRedirect;
			window.reloadRedirect = null;
			location.href = redirectURL;
		} else if (redirectURL) {
            location.href = redirectURL;
		} else {
            location.reload();
        }
	})
</script>